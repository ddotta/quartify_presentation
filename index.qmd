---
title: "quartify"
subtitle: "Transformez vos scripts R en documentation Quarto"
author: "Damien Dotta"
format:
  revealjs:
    theme: moon
    slide-number: true
    chalkboard: true
    preview-links: auto
    logo: https://raw.githubusercontent.com/ddotta/quartify/main/man/figures/hex_quartify.png
    css: styles.css
    footer: "quartify - De R Ã  Quarto en un clic"
    incremental: false
    transition: slide
    background-transition: fade
    highlight-style: github

execute:
  eval: false
---

## ğŸ“¦ Qu'est-ce que quartify ?

::: {.fragment}
Un package R qui **convertit automatiquement** vos scripts R en documents Quarto (.qmd)
:::

::: {.fragment}
ğŸ’¡ **L'idÃ©e** : GÃ©nÃ©rer de la documentation HTML Ã  partir de scripts R commentÃ©s
:::

::: {.fragment}
ğŸ¯ **L'objectif** : Garder les scripts les plus propres et familiers tout en les rendant compatibles avec l'Ã©co-systÃ¨me Quarto.
:::

---

## ğŸ¤” Le problÃ¨me

::: {.incremental}
- ğŸ“ Scripts R avec commentaires utiles mais **peu lisibles**
- ğŸ‘¥ Difficile Ã  **partager** avec des non-dÃ©veloppeurs
- ğŸ”„ **Duplication** entre code et documentation
- â° Temps perdu Ã  crÃ©er manuellement de la documentation
:::

---

## âœ¨ La solution quartify

::: {.incremental}
- **Automatisation** : Conversion R â†’ Quarto en un clic
- **PrÃ©servation** : Structure et commentaires conservÃ©s
- **Enrichissement** : Rendu HTML
- **FlexibilitÃ©** : des fonctions R, des addins RStudio sous forme de Shiny, une version web (sans installation requise)
- **Ã‰volutivitÃ©** : Du script simple au Quarto Book
:::

---

## ğŸ¯ Pourquoi Quarto ?

::: {.incremental}
- ğŸš€ **Successeur officiel** de R Markdown (nouvelle syntaxe et fonctionnalitÃ©s)
- ğŸ“ **Diagrammes** : Mermaid intÃ©grÃ© (flowcharts, sÃ©quences...)
- ğŸ“± **Responsive** : S'adapte Ã  tous les Ã©crans
- ğŸ”® **Future-proof** : DÃ©veloppement actif et communautÃ© croissante
:::

---

## ğŸ¯ Cas d'usage

### 1. Documentation technique

::: {.incremental}
- ğŸ“ Transformer scripts R â†’ Documentation HTML navigable
- ğŸ” Revues de code facilitÃ©es pour les Ã©quipes
- ğŸ‘¥ Partager analyses entre pairs
:::

---

## ğŸ¯ Cas d'usage

### 2. Gestion de projet

::: {.incremental}
- ğŸ“š CrÃ©er des Quarto Books pour projets complexes
- ğŸ—‚ï¸ Documentation centralisÃ©e et navigable
- ğŸ”„ IntÃ©gration CI/CD pour docs Ã  jour
:::

---

## ğŸš€ FonctionnalitÃ©s principales

::: {.incremental}
- ğŸ“ **Conversion R â†’ Quarto** : Scripts vers .qmd
- ğŸ—‚ï¸ **[Sections RStudio](https://docs.posit.co/ide/user/ide/guide/code/code-sections.html#code-sections)** : Reconnaissance automatique
- ğŸ’¬ **Commentaires prÃ©servÃ©s** : Texte dans le document final
- ğŸ”¢ **NumÃ©ros de lignes** : AccÃ¨s aux numÃ©ros de lignes dans le script R de dÃ©part
- ğŸ“Š **Blocs de code statiques**
- ğŸ“‘ **Table des matiÃ¨res** : Automatique
- ğŸ¨ **YAML personnalisable** : Titre, auteur, thÃ¨me, options
:::

---

## ğŸš€ FonctionnalitÃ©s principales (suite)

::: {.incremental}
- ğŸŒ **Rendu HTML** : Optionnel avec ouverture automatique
- ğŸ­ **25 thÃ¨mes Quarto** : Personnalisation visuelle
- ğŸ¨ **[Callouts](https://quarto.org/docs/authoring/callouts.html)** : Notes, tips, warnings...
- ğŸ“‘ **[Tabsets](https://quarto.org/docs/interactive/layout.html#tabset-panel)** : Organisation en onglets
- ğŸ“Š **[Diagrammes Mermaid](https://quarto.org/docs/authoring/diagrams.html)** : Flowcharts, sÃ©quences...
- ğŸ” **QualitÃ© du code** : IntÃ©gration styler/lintr
:::

---

## ğŸš€ FonctionnalitÃ©s principales (suite)

::: {.incremental}
- ğŸ“‚ **Conversion par lots** : RÃ©pertoires entiers
- ğŸ”§ **Add-in RStudio** : IntÃ©gration IDE
- ğŸ–¥ï¸ **Interface Shiny** : utilisation par tous les IDE
- ğŸŒ **Version web** : Pas d'installation nÃ©cessaire
- ğŸ“š **[Quarto Books](https://quarto.org/docs/books/)** : RÃ©pertoires vers livres navigables
- ğŸ¤– **Automatisation** : Compatible CI/CD
:::

---

## ğŸ› ï¸ Installation

### Depuis GitHub (version dÃ©veloppement)

```r
# Installation de devtools si nÃ©cessaire
install.packages("devtools")

# Installation de quartify
devtools::install_github("ddotta/quartify")

# Chargement du package
library(quartify)
```

---

## ğŸ› ï¸ Installation (suite)

### Depuis Cerise et le fichier tar.gz

```r
install.packages("~/CERISE/01-Espace-de-Partage/SSP/BMIS/__packages__/quartify_1.1.0.tar.gz", repos = NULL, type = "source")
```

### Depuis CRAN (quand disponible)

```r
install.packages("quartify")
library(quartify)
```

::: {.callout-note}
Actuellement en dÃ©veloppement - utilisez GitHub
:::

---

## ğŸŒ Version Web - Sans installation !

::: {.callout-tip icon=false}
## ğŸš€ Essayez immÃ©diatement !

**[https://quartify.lab.sspcloud.fr/](https://quartify.lab.sspcloud.fr/)**

âœ… Aucune installation R requise  
âœ… Interface web complÃ¨te  
âœ… Toutes les fonctionnalitÃ©s disponibles
:::

---

## ğŸŒ FonctionnalitÃ©s de la version web

::: {.incremental}
1. **Upload de fichiers** : Un ou plusieurs scripts R
2. **Conversion de rÃ©pertoire** : SÃ©lection d'un dossier entier
3. **CrÃ©ation de Books** : GÃ©nÃ©ration automatique de livres Quarto
4. **Configuration** : Titre, auteur, thÃ¨me, options de rendu
5. **TÃ©lÃ©chargement** : .qmd, .html, ou archive .zip complÃ¨te
:::

---

## ğŸŒ Avantages de la version web

::: {.incremental}
- **Accessible** : Depuis n'importe quel navigateur
- **Rapide** : Pas de setup local nÃ©cessaire
- **Partageable** : Envoyez le lien Ã  vos collÃ¨gues
- **Mise Ã  jour** : Toujours la derniÃ¨re version
- **Sans risque** : Pas d'installation sur votre machine
- **DÃ©monstration** : Parfait pour tester avant installation
:::

---

## ğŸ’» Trois faÃ§ons d'utiliser quartify

### 1ï¸âƒ£ Interface Shiny

```r
library(quartify)
quartify_app()  # Lance l'application dans le navigateur
```

::: {.fragment}
**Public cible** : Utilisateurs prÃ©fÃ©rant une interface graphique et qui utilisent un IDE diffÃ©rent de RStudio
:::

---

## ğŸ’» Trois faÃ§ons d'utiliser quartify

### 2ï¸âƒ£ Add-in RStudio

1. Ouvrir un script R dans RStudio
2. Menu **Addins** â†’ **Convert R Script to Quarto**

::: {.fragment}
**Public cible** : Utilisateurs prÃ©fÃ©rant une interface graphique et workflow intÃ©grÃ© dans RStudio
:::

---

## ğŸ’» Trois faÃ§ons d'utiliser quartify

### 3ï¸âƒ£ Ligne de commande (CLI)

```r
library(quartify)
rtoqmd("mon_script.R", "output.qmd")
```

::: {.fragment}
**IdÃ©al pour** : Scripts, automatisation CI/CD...
:::

---

## ğŸ’» Interface Shiny - DÃ©tails

### Onglet "Convertir un fichier"

::: {.incremental}
- ğŸ“ SÃ©lection du fichier R source
- ğŸ“ Configuration du nom de sortie
- âš™ï¸ Options : titre, auteur, format, thÃ¨me
- ğŸ¨ Choix du thÃ¨me parmi 25+ disponibles
- ğŸ”§ Options avancÃ©es : numÃ©rotation, table des matiÃ¨res
- ğŸ“Š Options de rendu : HTML, ouverture auto
:::

---

## ğŸ’» Interface Shiny - DÃ©tails (suite)

### Onglet "Convertir un rÃ©pertoire"

::: {.incremental}
- ğŸ“‚ SÃ©lection d'un rÃ©pertoire de scripts
- ğŸ“š Option "CrÃ©er un Quarto Book" (par dÃ©faut)
- ğŸ—‚ï¸ Configuration du rÃ©pertoire de sortie
- âš™ï¸ Options communes : auteur, thÃ¨me, rendu
- ğŸŒ GÃ©nÃ©ration optionnelle de HTML pour tous les fichiers
:::

---

## ğŸ’» Interface Shiny - DÃ©tails (suite)

### Onglet "Convertir plusieurs fichiers"

::: {.incremental}
- ğŸ“ Upload de plusieurs fichiers R en une fois
- ğŸ“¦ Traitement par lots
- ğŸ“š Option "CrÃ©er un Quarto Book"
- ğŸ’¾ TÃ©lÃ©chargement d'une archive ZIP complÃ¨te
- âš™ï¸ Configuration unifiÃ©e pour tous les fichiers
:::

---

## ğŸ”§ Fonction principale : rtoqmd()

### Syntaxe de base

```r
rtoqmd(
  input_file,           # Fichier R source
  output_file = NULL,   # Fichier .qmd de sortie (auto si NULL)
  title = NULL,         # Titre du document
  author = NULL,        # Auteur
  format = "html",      # Format de sortie
  theme = "cosmo",      # ThÃ¨me Quarto
  render = TRUE,        # GÃ©nÃ©rer HTML ?
  open_html = TRUE      # Ouvrir HTML automatiquement ?
)
```

---

## ğŸ”§ ParamÃ¨tres de rtoqmd()

### ParamÃ¨tres de base

::: {.incremental}
- **input_file** : Chemin du script R source
- **output_file** : Nom du fichier .qmd (par dÃ©faut : mÃªme nom)
- **title** : Titre dans l'en-tÃªte YAML (sinon depuis mÃ©tadonnÃ©es ou nom fichier)
- **author** : Auteur (sinon depuis mÃ©tadonnÃ©es)
- **format** : pour l'instant que "html"
:::

---

## ğŸ”§ ParamÃ¨tres de rtoqmd() (suite)

### ParamÃ¨tres de personnalisation

::: {.incremental}
- **theme** : Parmi 25 thÃ¨mes Quarto (dÃ©faut: "cosmo")
- **number_sections** : NumÃ©roter les sections ? (dÃ©faut: FALSE)
- **show_source_line** : Afficher les numÃ©ros de ligne originaux dans les chunks de code (dÃ©faut : TRUE)
- **toc** : Inclure table des matiÃ¨res ? (dÃ©faut: TRUE)
- **toc_title** : Titre de la TOC (dÃ©faut: "Sommaire")
- **toc_depth** : Profondeur de la TOC (dÃ©faut: 3)
:::

---

## ğŸ”§ ParamÃ¨tres de rtoqmd() (suite)

### ParamÃ¨tres de sortie

::: {.incremental}
- **render** : GÃ©nÃ©rer le HTML ? (dÃ©faut: TRUE)
- **output_html_file** : Nom du fichier HTML de sortie
- **open_html** : Ouvrir le HTML ? (dÃ©faut: TRUE)
- **use_styler** : Afficher suggestions de formatage (dÃ©faut: FALSE)
- **use_lintr** : Afficher problÃ¨mes de qualitÃ© (dÃ©faut: FALSE)
- âš  **apply_styler** : Appliquer formatage (dÃ©faut: FALSE)
:::

---

## ğŸ’» Exemples d'utilisation

### Exemple 1 : Conversion simple

```r
# Conversion basique avec rendu HTML
rtoqmd("analyse.R")

# GÃ©nÃ¨re : analyse.qmd + analyse.html
# Ouvre le HTML dans le navigateur
```

---

## ğŸ’» Exemples d'utilisation

### Exemple 2 : Sans rendu HTML

```r
# GÃ©nÃ©rer uniquement le .qmd
rtoqmd("analyse.R", 
       render = FALSE)

# GÃ©nÃ¨re : analyse.qmd uniquement
```

---

## ğŸ’» Exemples d'utilisation

### Exemple 3 : Personnalisation complÃ¨te

```r
rtoqmd(
  input_file = "mon_script.R",
  output_file = "rapport_detaille.qmd",
  title = "Analyse statistique des ventes 2024",
  author = "Ã‰quipe Data Science",
  format = "html",
  theme = "flatly",
  number_sections = TRUE,
  render = TRUE,
  output_html_file = "docs/rapport_ventes_2024.html",
  open_html = TRUE
)
```

---

## ğŸ’» Exemples d'utilisation

### Exemple 4 : Avec vÃ©rification qualitÃ©

```r
rtoqmd(
  input_file = "analyse.R",
  output_file = "analyse.qmd",
  use_styler = TRUE,    # Afficher suggestions de style
  use_lintr = TRUE,     # Afficher problÃ¨mes de qualitÃ©
  render = TRUE
)

# GÃ©nÃ¨re des tabsets avec :
# - Code original
# - Code formatÃ© (suggestion)
# - Issues de qualitÃ©
```

---

## ğŸ“‚ Conversion par rÃ©pertoire : rtoqmd_dir()

### Syntaxe

```r
rtoqmd_dir(
  input_dir,              # RÃ©pertoire contenant les .R
  output_dir = NULL,      # RÃ©pertoire de sortie (dÃ©faut: input_dir)
  create_book = TRUE,     # CrÃ©er un Quarto Book ?
  author = NULL,
  render = TRUE,
  output_html_dir = NULL,
  exclude_pattern = NULL  # Pattern pour exclure fichiers
)
```

---

## ğŸ“‚ Exemples de conversion par rÃ©pertoire

### Exemple 1 : Conversion simple d'un rÃ©pertoire

```r
# Convertir tous les .R d'un rÃ©pertoire
rtoqmd_dir("scripts/analyses")

# GÃ©nÃ¨re :
# - Un .qmd pour chaque .R
# - Un Quarto Book avec navigation
# - HTML pour chaque fichier
```

---

## ğŸ“‚ Exemples de conversion par rÃ©pertoire

### Exemple 2 : Sans crÃ©er de Book

```r
# Juste convertir les fichiers individuellement
rtoqmd_dir("scripts/", 
           create_book = FALSE)

# GÃ©nÃ¨re un .qmd et .html pour chaque .R
# Pas de structure de livre
```

---

## ğŸ“‚ Exemples de conversion par rÃ©pertoire

### Exemple 3 : Avec exclusion de fichiers

```r
# Exclure les fichiers de test
rtoqmd_dir(
  input_dir = "scripts/",
  exclude_pattern = "^test_.*\\.R$", 
  author = "Ã‰quipe Data",
  theme = "darkly"
)

# Tous les fichiers R dont le nom commence par test_ seront ignorÃ©s
```

---

## ğŸ“‚ Exemples de conversion par lots

### Exemple 4 : Organisation personnalisÃ©e

```r
# Sortie dans un rÃ©pertoire dÃ©diÃ©
rtoqmd_dir(
  input_dir = "R/analyses/",
  output_dir = "documentation/",
  output_html_dir = "docs/html/",
  create_book = TRUE,
  author = "Mon Ã©quipe",
  theme = "cosmo",
  render = TRUE
)
```

---

## ğŸ“š Quarto Books - Qu'est-ce que c'est ?

::: {.incremental}
- [Lien vers la documentation](https://quarto.org/docs/books/)
- ğŸ“– **Structure de livre** : Chapitres, parties, navigation
- ğŸ—‚ï¸ **Sidebar automatique** : Navigation entre tous les fichiers
- ğŸ” **Recherche intÃ©grÃ©e** : Chercher dans tout le livre
- ğŸ“± **Design responsive** : AdaptÃ© mobile/tablette/desktop
- ğŸ¨ **Personnalisable** : ThÃ¨mes, logo, favicon
- ğŸŒ **Publication facile** : Gitlab/GitHub Pages, Netlify, Quarto Pub...
:::

---

## ğŸ“š Structure d'un Quarto Book

```
_book/
â”œâ”€â”€ _quarto.yml          # Configuration du livre
â”œâ”€â”€ index.qmd            # Page d'accueil
â”œâ”€â”€ chapter1.qmd         # Chapitre 1
â”œâ”€â”€ chapter2.qmd         # Chapitre 2
â””â”€â”€ ...
```

::: {.fragment}
**quartify gÃ©nÃ¨re automatiquement** cette structure Ã  partir de vos scripts R !
:::

---

## ğŸ“š CrÃ©ation automatique de Books

```r
# Active par dÃ©faut avec rtoqmd_dir()
rtoqmd_dir("scripts/")

# GÃ©nÃ¨re :
# - _quarto.yml avec configuration
# - index.qmd comme page d'accueil
# - Un chapitre par script R
# - Navigation dans la sidebar
```

---

## ğŸ“š Contenu du _quarto.yml gÃ©nÃ©rÃ©

```yaml
project:
  type: book
  output-dir: _book

book:
  title: "Documentation"
  author: "Votre nom"
  chapters:
    - index.qmd
    - chapter1.qmd
    - chapter2.qmd

format:
  html:
    theme: cosmo
```

---

## ğŸ“š Avantages des Quarto Books

::: {.incremental}
- ğŸ¯ **Organisation claire** : Structure projet complexe
- ğŸ“– **Navigation fluide** : Entre tous les chapitres
- ğŸ” **Recherche globale** : Dans tout le contenu
- ğŸ“± **ExpÃ©rience optimale** : Lecture sur tous supports
:::

---

## ğŸ“ Format du script R source

### Structure recommandÃ©e

```r
# Title : Titre de l'analyse
#
# Author : Votre nom
#
# Date : 2025-12-10
#
# Description : Description dÃ©taillÃ©e
# de ce que fait ce script
#

## Section principale ####

# Commentaire explicatif

code_r <- "exemple"
```

---

## ğŸ“ MÃ©tadonnÃ©es (optionnel)

### En dÃ©but de script

```r
# Title : Analyse des donnÃ©es Iris
#
# Author : Jane Doe
#
# Date : 2025-12-05
#
# Description : Cette analyse explore les diffÃ©rences
# entre les trois espÃ¨ces d'iris en utilisant
# des mÃ©thodes statistiques avancÃ©es.
#
```

::: {.callout-note}
Si absent, quartify utilise le nom du fichier comme titre
:::

---

## ğŸ“ Sections et sous-sections

### Syntaxe RStudio

```r
## Titre niveau 2 (Heading 2) ####

### Titre niveau 3 (Heading 3) ====

#### Titre niveau 4 (Heading 4) ----
```

::: {.callout-important}
Minimum **4 symboles** Ã  la fin (`#`, `=` ou `-`)
:::

---

## ğŸ“ HiÃ©rarchie des sections

```r
# Titre niveau 1 (titre du document YAML)

## Import des donnÃ©es ####

### Lecture CSV ====

#### VÃ©rification qualitÃ© ----

## Analyse exploratoire ####

### Statistiques descriptives ====
```

---

## ğŸ“ Commentaires â†’ Texte

### RÃ¨gle de base

```r
# Ce commentaire seul sur sa ligne
# devient du texte dans le document Quarto

iris |> filter(Species == "setosa")
```

::: {.fragment}
**Devient dans le .qmd :**
````markdown
Ce commentaire seul sur sa ligne
devient du texte dans le document Quarto

```{.r}
Ligne 4
iris |> filter(Species == "setosa")
```
````
:::

---

## ğŸ“ Commentaires inline (dans le code)

```r
iris |> 
  # Ce commentaire avec espace avant reste dans le code
  filter(Species == "setosa") |>
  select(Sepal.Length)  # Commentaire en fin de ligne reste aussi
```

::: {.callout-warning}
Commentaires **prÃ©cÃ©dÃ©s d'espace** ou **en fin de ligne** restent dans le bloc de code !
:::

---

## ğŸ“ Commentaires cachÃ©s

Vous pouvez inclure des notes privÃ©es ou des commentaires de dÃ©veloppement dans vos scripts R qui n'apparaÃ®tront pas dans le rendu final. Les commentaires qui commencent par `#` immÃ©diatement suivi d'un caractÃ¨re non-espace sont complÃ¨tement ignorÃ©s :

```r
# Ce commentaire APPARAITRA dans la sortie

#Ceci n'apparaitra PAS (pas d'espace aprÃ¨s #)
#TODO: Ceci non plus
#DEBUG code ci-dessous

# Ce commentaire rÃ©gulier APPARAITRA Ã  nouveau
```

---

## ğŸ“ Exemples de conversion

### Script R

```r
## Analyse descriptive ####

# Calculer les statistiques de base

summary(iris)

# La fonction summary() fournit :
# - Minimum et maximum
# - Quartiles
# - Moyenne

### Distribution des espÃ¨ces ====

table(iris$Species)
```

---

## ğŸ“ Document Quarto gÃ©nÃ©rÃ©

````markdown
## Analyse descriptive

Calculer les statistiques de base

```{.r}
Ligne 5
summary(iris)
```

La fonction summary() fournit :
- Minimum et maximum
- Quartiles
- Moyenne

### Distribution des espÃ¨ces

```{.r}
Ligne 14
table(iris$Species)
```
````

---

### Snippets RStudio

Installez des snippets de code utiles pour une Ã©criture de script R plus rapide avec `install_quartify_snippets()`.

AprÃ¨s installation et redÃ©marrage de RStudio, vous pouvez utiliser :

- **`header`** + Tab : InsÃ©rer un modÃ¨le de mÃ©tadonnÃ©es de document
- **`callout`** + Tab : InsÃ©rer un modÃ¨le de callout
- **`mermaid`** + Tab : InsÃ©rer un modÃ¨le de diagramme Mermaid
- **`tabset`** + Tab : InsÃ©rer un modÃ¨le de tabset

---

## ğŸ¨ Callouts - Qu'est-ce que c'est ?

::: {.callout-note}
## Note
Blocs de texte **mis en Ã©vidence** pour attirer l'attention
:::

::: {.callout-tip}
## Astuce
Conseils et bonnes pratiques
:::

::: {.callout-warning}
## Attention
Points importants nÃ©cessitant vigilance
:::

---

## ğŸ¨ Syntaxe des Callouts

### Dans le script R

```r
# callout-note - Titre du callout
# Contenu du callout sur plusieurs lignes.
# Chaque ligne commence par #
# 
# Peut inclure des paragraphes.

code_apres_callout <- "exemple"
```

---

## ğŸ¨ Types de Callouts

### 5 types disponibles

```r
# callout-note - Information gÃ©nÃ©rale
# callout-tip - Conseil, astuce
# callout-warning - Attention requise
# callout-caution - Prudence nÃ©cessaire
# callout-important - Point crucial
```

---

## ğŸ¨ Exemple de Callout

### Script R

```r
## Chargement des donnÃ©es ####

# callout-important - PrÃ©requis
# Assurez-vous d'avoir installÃ© le package readr :
# install.packages("readr")

library(readr)
data <- read_csv("fichier.csv")
```

---

## ğŸ¨ Rendu du Callout

::: {.callout-important}
## PrÃ©requis
Assurez-vous d'avoir installÃ© le package readr :  
`install.packages("readr")`
:::

```r
library(readr)
data <- read_csv("fichier.csv")
```

---

## ğŸ“Š Diagrammes Mermaid

### Qu'est-ce que Mermaid ?

::: {.incremental}
- ğŸ“ **Langage de diagrammes** : Syntaxe simple type Markdown
- ğŸ¨ **Rendu automatique** : GÃ©nÃ©rÃ© lors du rendu Quarto
- ğŸ”„ **IntÃ©grÃ© nativement** : Pas d'extension nÃ©cessaire
- ğŸ“Š **Multiples types** : Flowcharts, sÃ©quences, Gantt, classes...
:::

---

## ğŸ“Š Syntaxe Mermaid dans quartify

### Dans le script R

```r
#| mermaid
#| eval: true
# flowchart TD
#     A[DÃ©but] --> B[Traitement]
#     B --> C{DÃ©cision}
#     C -->|Oui| D[Fin]
#     C -->|Non| B
```

::: {.callout-note}
Utiliser les balises `#|` pour les options du chunk
:::

---

## ğŸ“Š Types de diagrammes Mermaid

### Flowchart

```r
#| mermaid
#| eval: true
# flowchart LR
#     A[Raw data] --> B[Cleaning]
#     B --> C[Analysis]
#     C --> D[Visualization]
#     D --> E[Report]
```

![](images/flowchart_LR.png)

---

## ğŸ“Š Types de diagrammes Mermaid

### Diagramme de sÃ©quence

```r
#| mermaid
#| eval: true
# sequenceDiagram
#     User->>API: Request
#     API->>Database: Query
#     Database-->>API: Results
#     API-->>User: Response
```

![](images/sequence_diagram.png)

---

## ğŸ“Š Types de diagrammes Mermaid

### Diagramme de classes

```r
#| mermaid
#| eval: true
# classDiagram
#     class Animal {
#         +String nom
#         +int age
#         +eat()
#     }
#     class Dog {
#         +bark()
#     }
#     Animal <|-- Dog
```

![](images/class_diagram.png)

---

## ğŸ“Š Types de diagrammes Mermaid

### Gantt (planning)

```r
#| mermaid
#| eval: true
# gantt
#     title Project planning
#     dateFormat YYYY-MM-DD
#     section Phase 1
#     Data collection :2025-01-01, 30d
#     Cleaning        :2025-01-31, 20d
#     section Phase 2
#     Analysis        :2025-02-20, 30d
# 
```

![](images/gantt.png)

---

## ğŸ“‘ Tabsets - Organisation en onglets

### Qu'est-ce que c'est ?

::: {.incremental}
- [Lien vers la documentation](https://quarto.org/docs/interactive/layout.html#tabset-panel)
- ğŸ“‘ **Onglets interactifs** : Organiser le contenu
- ğŸ‘† **Cliquable** : L'utilisateur choisit quoi voir
- ğŸ¯ **Gain de place** : Ã‰viter trop de scrolling
- ğŸ“Š **Comparaison** : Afficher diffÃ©rentes vues
:::

---

## ğŸ“‘ Syntaxe des Tabsets

### Dans le script R

```r
# tabset

# tab - Onglet 1
# Description du premier onglet

code_onglet1 <- "exemple"

# tab - Onglet 2
# Description du second onglet

code_onglet2 <- "autre exemple"
```

---

## ğŸ“‘ Exemple de Tabset

### Script R

```r
## Exploration des donnÃ©es ####

# tabset

# tab - RÃ©sumÃ©
# Statistiques descriptives

summary(iris)

# tab - Structure
# Structure du dataset

str(iris)

# tab - AperÃ§u
# PremiÃ¨res lignes

head(iris)
```

---

## ğŸ“‘ Rendu du Tabset

![](images/tabset_example.png)

---

## ğŸ” QualitÃ© du code - styler

### Qu'est-ce que styler ?

::: {.incremental}
- âœ¨ **Formatage automatique** : Suit le [style guide tidyverse](https://style.tidyverse.org/)
- ğŸ¯ **CohÃ©rence** : Code uniforme dans tout le projet
- ğŸ“ **LisibilitÃ©** : Indentation, espaces, sauts de ligne
- ğŸ”§ **IntÃ©grÃ© quartify** : Afficher ou appliquer le formatage
:::

---

## ğŸ” Utilisation de styler

### Option 1 : Afficher les suggestions

```r
rtoqmd("script.R", 
       use_styler = TRUE)

# GÃ©nÃ¨re un tabset avec :
# - "Code original" : Votre code
# - "Code formatÃ©" : Version stylÃ©e
```

::: {.callout-note}
N'applique PAS les modifications, juste une suggestion
:::

---

## ğŸ” Utilisation de styler

### Option 2 : Appliquer directement

```r
rtoqmd("script.R", 
       apply_styler = TRUE)
```

::: {.callout-warning}
## âš ï¸ Attention !
Modifie le fichier R source directement. Faites un backup !
:::

---

## ğŸ” Exemple de formatage styler

### Avant (original)

```r
x=1+2
if(x>0){
print("positif")}
df<-data.frame(a=1:3,b=4:6)
```

### AprÃ¨s (formatÃ©)

```r
x <- 1 + 2
if (x > 0) {
  print("positif")
}
df <- data.frame(a = 1:3, b = 4:6)
```

---

## ğŸ” QualitÃ© du code - lintr

### Qu'est-ce que lintr ?

::: {.incremental}
- ğŸ” **Analyse statique** : DÃ©tecte problÃ¨mes potentiels
- âš ï¸ **Warnings** : Syntaxe, style, erreurs potentielles
- ğŸ“Š **Bonnes pratiques** : Conventions R recommandÃ©es
- ğŸ”§ **IntÃ©grÃ© quartify** : Affiche les issues dans un tabset
:::

---

## ğŸ” Utilisation de lintr

```r
rtoqmd("script.R", 
       use_lintr = TRUE)

# GÃ©nÃ¨re un tabset avec :
# - "Code original" : Votre code
# - "Issues" : Liste des problÃ¨mes dÃ©tectÃ©s
```

---

## ğŸ” Combiner styler + lintr

```r
rtoqmd("script.R", 
       use_styler = TRUE,
       use_lintr = TRUE)

# GÃ©nÃ¨re un tabset avec 3 onglets :
# - "Code original"
# - "Code formatÃ©" (suggestion styler)
# - "Issues" (problÃ¨mes lintr)
```

::: {.callout-tip}
Parfait pour la revue de code !
:::

---

## ğŸ” Types de problÃ¨mes dÃ©tectÃ©s par lintr

::: {.incremental}
- ğŸš« **Syntaxe** : Erreurs de code
- ğŸ“ **Longueur de ligne** : > 80 caractÃ¨res
- ğŸ”¤ **Naming** : Conventions de nommage
- âš ï¸ **Variables non utilisÃ©es**
- ğŸ”„ **Code dupliquÃ©**
- ğŸ“¦ **Packages** : DÃ©pendances manquantes
- ğŸ¨ **Style** : Indentation, espaces...
:::

---

## âœï¸ Utiliser apply_styler

::: {.incremental}
- âš ï¸ Le paramÃ¨tre `apply_styler` permet de formater **dÃ©finitivement** vos fichiers de scripts R selon le guide de style tidyverse.
- Le paramÃ¨tre `apply_styler` ne fonctionne que si `use_styler = TRUE`. 
- Si vous dÃ©finissez `apply_styler = TRUE` mais `use_styler = FALSE`, vous recevrez un avertissement et le fichier source ne sera pas modifiÃ©.
- Le fichier source est modifiÃ© AVANT la conversion
- Le fichier formatÃ© est ensuite utilisÃ© pour la conversion en .qmd
:::

---

## Rendu de styler et lintr


![](images/record_quartify.mp4)


## ğŸ¨ ThÃ¨mes Quarto disponibles

### ThÃ¨mes clairs (19)

cosmo, flatly, journal, litera, lumen, lux, materia, minty, morph, pulse, quartz, sandstone, simplex, sketchy, spacelab, united, vapor, yeti, zephyr

### ThÃ¨mes sombres (6)

darkly, cyborg, slate, solar, superhero, vapor

---

## ğŸ¨ Choix du thÃ¨me

### Avec l'interface

- Menu dÃ©roulant avec aperÃ§u
- PrÃ©visualisation en temps rÃ©el

### En ligne de commande

```r
rtoqmd("script.R", theme = "flatly")
```

---

## ğŸ¨ Exemples de thÃ¨mes

### ThÃ¨me "cosmo" (dÃ©faut)

- ğŸ¨ Design moderne et Ã©purÃ©
- ğŸ“± TrÃ¨s responsive
- ğŸ”µ Palette bleue professionnelle

### ThÃ¨me "darkly"

- ğŸŒ™ Fond sombre (dark mode)
- ğŸ‘ï¸ Confortable pour les yeux
- ğŸ’» ApprÃ©ciÃ© des dÃ©veloppeurs

---

## ğŸ”„ IntÃ©gration CI/CD

### Pourquoi automatiser ?

::: {.incremental}
- ğŸ“… **Documentation toujours Ã  jour** : Ã€ chaque commit
- ğŸ¤– **Pas d'oubli** : Automatique
- ğŸ‘¥ **Collaboration** : Toute l'Ã©quipe bÃ©nÃ©ficie
- ğŸš€ **DÃ©ploiement** : Publication auto sur Gitlab/GitHub Pages par exemple
:::

---

## ğŸ”„ GitLab CI - Configuration

### Fichier .gitlab-ci.yml

```yaml
generate-docs:
  image: ddottaagr/quartify:latest
  stage: build
  script:
    - R -e "quartify::rtoqmd_dir('scripts/', 
            render = TRUE)"
  artifacts:
    paths:
      - scripts/**/*.qmd
      - scripts/**/*.html
```

---

## ğŸ”„ GitLab CI (interne MAASA)- Configuration

### Fichier .gitlab-ci.yml

Voir [ce projet](https://gitlab.forge.agriculture.rie.gouv.fr/ssp/bmis/divers/quartify_gur).

```yaml
variables:
  DOCKER_AUTH_CONFIG: >
    {"auths": {"${FORGE_REVERSE_HOST}": {"auth": "${ARTIFACTORY_ROBOT_AUTH_TOKEN}"}}}

generate-docs:
  image:
    name: ${FORGE_REVERSE_HOST}/hub-docker-prod-remote/ddottaagr/quartify:latest
  stage: build
  script:
    - R -e "quartify::rtoqmd_dir('scripts/', render = TRUE)"
  artifacts:
    paths:
      - scripts/**/*.qmd
      - scripts/**/*.html
```

---

## ğŸ”„ GitHub Actions - Configuration

### Fichier .github/workflows/quartify.yml

```yaml
name: Generate Documentation

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  generate-docs:
    runs-on: ubuntu-latest
```

---

## ğŸ”„ GitHub Actions - Suite

```yaml
    steps:
      - uses: actions/checkout@v4
      
      - uses: r-lib/actions/setup-r@v2
        with:
          r-version: '4.5.1'
      
      - name: Install quartify
        run: |
          install.packages("devtools")
          devtools::install_github("ddotta/quartify")
        shell: Rscript {0}
```

---

## ğŸ”„ GitHub Actions - GÃ©nÃ©ration

```yaml
      - name: Generate documentation
        run: |
          library(quartify)
          rtoqmd_dir("scripts/", 
                     render = TRUE,
                     author = "Ã‰quipe Data")
        shell: Rscript {0}
      
      - uses: actions/upload-artifact@v4
        with:
          name: documentation
          path: |
            scripts/**/*.qmd
            scripts/**/*.html
```

---

## ğŸ”— Ressources et documentation

### Documentation officielle

::: {.incremental}
- ğŸ“¦ **GitHub** : [github.com/ddotta/quartify](https://github.com/ddotta/quartify)
- ğŸ“– **Site documentation** : [ddotta.github.io/quartify](https://ddotta.github.io/quartify/)
- ğŸŒ **Version web** : [quartify.lab.sspcloud.fr](https://quartify.lab.sspcloud.fr/)
:::

---

## ğŸ”— Ressources et documentation (suite)

### Guides et tutoriels

::: {.incremental}
- ğŸ“ **[Getting Started](https://ddotta.github.io/quartify/articles/getting-started.html)**
- ğŸ“ **[Advanced Features](https://ddotta.github.io/quartify/articles/advanced-features.html)**
- ğŸ“ **Exemples** : Dans le repo (`inst/examples/`)
- ğŸ“š **Quarto docs** : [quarto.org](https://quarto.org)
- ğŸ’¬ **Issues GitHub** : [Questions et support](https://github.com/ddotta/quartify/issues)
:::

---

## ğŸ™ Merci !

::: {.columns}
::: {.column width="60%"}
### Questions ?

ğŸ“§ **GitHub Issues** pour questions/bugs  
ğŸŒŸ **Star le projet** sur GitHub !  
ğŸ¤ **Contributions** bienvenues
:::
:::